import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.WFquGv8Z.js";import{s as i}from"./supabase.B9bYqD4q.js";import w from"./AuthModal.Brc0PkPI.js";import"./index.DR2MMlUt.js";function S(){const[t,u]=r.useState(null),[n,d]=r.useState(null),[p,x]=r.useState(!1),[l,h]=r.useState(null);r.useEffect(()=>{i.auth.getSession().then(({data:{session:o}})=>{u(o),o&&f(o.user.id)});const{data:{subscription:s}}=i.auth.onAuthStateChange((o,c)=>{u(c),c?f(c.user.id):h(null)}),a=localStorage.getItem("user_wallet");return a&&d(a),()=>s.unsubscribe()},[]);const f=async s=>{const{data:a}=await i.from("profiles").select("avatar_url, full_name").eq("id",s).single();h(a)},m=async()=>{t?await i.auth.signOut():n&&(localStorage.removeItem("user_wallet"),d(null),window.location.reload())},b=s=>s?`${s.slice(0,6)}...${s.slice(-4)}`:"";return t||n?e.jsxs("div",{className:"relative group",children:[e.jsx("a",{href:"/profile",className:"flex items-center gap-3 hover:opacity-80 transition-opacity",children:e.jsx("div",{className:"w-8 h-8 rounded-full bg-[#D4AF37] flex items-center justify-center text-black font-bold text-xs overflow-hidden border border-[#D4AF37]",children:t?l?.avatar_url?e.jsx("img",{src:l.avatar_url,className:"w-full h-full object-cover"}):e.jsx("span",{children:l?.full_name?.[0]||t.user.email[0].toUpperCase()}):e.jsx("span",{className:"text-[10px]",children:"0x"})})}),e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-48 bg-[#111] border border-white/10 rounded-xl shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50 overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-white/5",children:[e.jsx("p",{className:"text-white text-xs font-bold truncate",children:t?l?.full_name||"User":"Metamask User"}),e.jsx("p",{className:"text-white/40 text-[10px] truncate",children:t?t.user.email:b(n)})]}),t&&e.jsx("a",{href:"/profile",className:"block px-4 py-3 text-white/70 hover:text-[#D4AF37] hover:bg-white/5 text-xs font-bold uppercase tracking-wider transition-colors",children:"My Profile"}),e.jsx("button",{onClick:m,className:"w-full text-left px-4 py-3 text-red-400 hover:text-red-300 hover:bg-white/5 text-xs font-bold uppercase tracking-wider transition-colors",children:"Sign Out"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>x(!0),className:"text-xs font-bold uppercase tracking-widest text-white/90 hover:text-[#D4AF37] transition-colors",children:"Login"}),e.jsx(w,{isOpen:p,onClose:()=>x(!1)})]})}export{S as default};
