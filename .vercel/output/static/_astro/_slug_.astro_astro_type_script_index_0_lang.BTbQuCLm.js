import{c as u}from"./index.DR2MMlUt.js";const a=u("https://euavftppzicwjhbugiys.supabase.co","sb_publishable_poJ-NobQZpARz_G4cWG96Q_vxIPZkrE"),m=async()=>{const{data:{session:t}}=await a.auth.getSession();return t?document.getElementById("review-form-container")?.classList.remove("hidden"):document.getElementById("login-prompt")?.classList.remove("hidden"),t},s=await m(),l=document.querySelectorAll(".star-btn"),g=document.getElementById("rating-input");l.forEach(t=>{t.addEventListener("click",()=>{const n=parseInt(t.getAttribute("data-val")||"0");g.value=n.toString(),l.forEach(e=>{parseInt(e.getAttribute("data-val")||"0")<=n?(e.classList.add("text-yellow-500"),e.classList.remove("text-white/20")):(e.classList.remove("text-yellow-500"),e.classList.add("text-white/20"))})})});const i=document.getElementById("like-btn"),r=document.getElementById("like-count");i?.addEventListener("click",async()=>{if(!r)return;let t=parseInt(r.innerText);if(r.innerText=(t+1).toString(),i.classList.add("text-[#D4AF37]"),s){const n=i.getAttribute("data-id"),{error:e}=await a.from("articles").update({likes_count:t+1}).eq("id",n);e&&console.error("Like failed",e)}});const p=document.getElementById("review-form");p?.addEventListener("submit",async t=>{t.preventDefault();const n=new FormData(t.target),e=n.get("comment"),o=n.get("rating"),d=document.getElementById("like-btn")?.getAttribute("data-id");if(!s||!s.user)return;const{error:c}=await a.from("article_reviews").insert({article_id:d,user_id:s.user.id,rating:parseInt(o),comment:e});c?alert("Error submitting review: "+c.message):window.location.reload()});
