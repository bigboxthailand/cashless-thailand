import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as l}from"./index.WFquGv8Z.js";import{s as y}from"./supabase.B9bYqD4q.js";import"./index.DR2MMlUt.js";const F=({productId:n})=>{const[o,f]=l.useState([]),[a,u]=l.useState({average:0,total:0,counts:{5:0,4:0,3:0,2:0,1:0}}),[w,p]=l.useState(!0);l.useEffect(()=>{n&&g()},[n]);const g=async()=>{try{const{data:t,error:r}=await y.from("reviews").select(`
                    *,
                    profile:user_id (full_name, avatar_url)
                `).ilike("product_id",`${n}%`).order("created_at",{ascending:!1});if(r)throw r;f(t),v(t)}catch(t){console.error("Error fetching reviews:",t)}finally{p(!1)}},v=t=>{if(!t.length)return;const r={5:0,4:0,3:0,2:0,1:0};let m=0;t.forEach(h=>{r[h.rating]=(r[h.rating]||0)+1,m+=h.rating}),u({average:(m/t.length).toFixed(1),total:t.length,counts:r})},[s,j]=l.useState(1),c=5,i=Math.ceil(o.length/c),x=s*c,b=x-c,N=o.slice(b,x),d=t=>j(t);return w?e.jsx("div",{className:"text-white/40 text-center py-10 animate-pulse",children:"Loading reviews..."}):o.length===0?e.jsxs("div",{className:"text-center py-20 border-t border-white/5",children:[e.jsx("div",{className:"w-16 h-16 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-4 text-[#D4AF37]/50",children:e.jsx("span",{className:"text-2xl",children:"★"})}),e.jsx("h3",{className:"text-white font-bold uppercase tracking-widest mb-1",children:"No Reviews Yet"}),e.jsx("p",{className:"text-white/40 text-sm",children:"Be the first to review this product!"})]}):e.jsxs("div",{className:"max-w-[1200px] mx-auto px-6 py-20 border-t border-white/5",id:"reviews-section",children:[e.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tighter mb-12",children:"Customer Reviews"}),e.jsxs("div",{className:"grid lg:grid-cols-12 gap-12",children:[e.jsxs("div",{className:"lg:col-span-4 bg-[#111] border border-white/5 rounded-[2rem] p-8 h-fit",children:[e.jsxs("div",{className:"flex items-end gap-4 mb-8",children:[e.jsx("span",{className:"text-6xl font-black text-white leading-none",children:a.average}),e.jsxs("div",{className:"mb-2",children:[e.jsx("div",{className:"flex text-[#D4AF37] text-lg mb-1",children:"★".repeat(Math.round(a.average)).padEnd(5,"☆")}),e.jsxs("p",{className:"text-white/40 text-xs font-bold uppercase tracking-widest",children:[a.total," Reviews"]})]})]}),e.jsx("div",{className:"space-y-3",children:[5,4,3,2,1].map(t=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-white/40 font-mono text-xs w-3",children:t}),e.jsx("div",{className:"flex-1 h-2 bg-white/5 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-[#D4AF37]",style:{width:`${a.counts[t]/a.total*100}%`}})}),e.jsx("span",{className:"text-white/40 font-mono text-xs w-6 text-right",children:a.counts[t]})]},t))})]}),e.jsxs("div",{className:"lg:col-span-8 space-y-6",children:[N.map(t=>e.jsxs("div",{className:"bg-[#0a0a0a] border border-white/5 rounded-2xl p-6 hover:border-[#D4AF37]/30 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center overflow-hidden border border-white/10",children:t.profile?.avatar_url?e.jsx("img",{src:t.profile.avatar_url,className:"w-full h-full object-cover"}):e.jsx("span",{className:"font-bold text-[#D4AF37]",children:t.profile?.full_name?.[0]||"U"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-bold text-sm",children:t.profile?.full_name||"Anonymous User"}),e.jsx("div",{className:"flex text-[#D4AF37] text-xs",children:"★".repeat(t.rating).padEnd(5,"☆")})]})]}),e.jsx("span",{className:"text-white/20 text-[10px] font-bold uppercase tracking-widest",children:new Date(t.created_at).toLocaleDateString("th-TH")})]}),e.jsx("p",{className:"text-white/70 font-light leading-relaxed",children:t.comment})]},t.id)),i>1&&e.jsxs("div",{className:"flex justify-center items-center gap-4 pt-8",children:[e.jsx("button",{onClick:()=>{d(Math.max(1,s-1)),document.getElementById("reviews-section").scrollIntoView({behavior:"smooth"})},disabled:s===1,className:`w-10 h-10 rounded-full flex items-center justify-center border transition-all ${s===1?"border-white/5 text-white/20 cursor-not-allowed":"border-white/10 text-white hover:border-[#D4AF37] hover:text-[#D4AF37]"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),e.jsx("div",{className:"flex items-center gap-2",children:Array.from({length:i},(t,r)=>r+1).map(t=>e.jsx("button",{onClick:()=>{d(t),document.getElementById("reviews-section").scrollIntoView({behavior:"smooth"})},className:`w-8 h-8 rounded-full text-xs font-bold transition-all ${s===t?"bg-[#D4AF37] text-black":"bg-transparent text-white/40 hover:text-white"}`,children:t},t))}),e.jsx("button",{onClick:()=>{d(Math.min(i,s+1)),document.getElementById("reviews-section").scrollIntoView({behavior:"smooth"})},disabled:s===i,className:`w-10 h-10 rounded-full flex items-center justify-center border transition-all ${s===i?"border-white/5 text-white/20 cursor-not-allowed":"border-white/10 text-white hover:border-[#D4AF37] hover:text-[#D4AF37]"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})})]})]})]})]})};export{F as default};
